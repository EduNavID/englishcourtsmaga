<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login & Sign Up - English Court SMAN 3 Lamongan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background: linear-gradient(to bottom right, #eff6ff, #dbeafe); 
        }
        .page-container {
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
        }
        .page-container.is-exiting {
            opacity: 0;
            transform: translateY(-10px);
        }
    </style>
</head>
<body class="text-slate-800">

    <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <img src="https://lh3.googleusercontent.com/d/1B-cM3hX_k_zJ1C5v5i5w1R9y5p1Z5f4P" alt="Logo SMAN 3 Lamongan" class="h-12 w-12">
                <div class="h-12 w-12 rounded-full border-2 border-dashed border-slate-400 flex items-center justify-center">
                    <span class="text-xs font-semibold text-slate-500 text-center">EC Logo</span>
                </div>
                <span class="text-xl font-bold text-blue-700 hidden sm:block">English Court</span>
            </div>
            <button id="nav-toggle-button" class="font-semibold text-blue-600 border border-blue-600 px-4 py-2 rounded-lg hover:bg-blue-600 hover:text-white transition-colors duration-300">
                Sign Up
            </button>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-12 flex items-center justify-center flex-grow">
        <div id="signup-container" class="w-full max-w-md page-container hidden">
            <div class="bg-white p-8 md:p-10 rounded-2xl shadow-2xl">
                <div id="signup-view">
                    <h2 class="text-3xl font-extrabold text-center text-slate-900 mb-2">Create Account</h2>
                    <p class="text-center text-slate-500 mb-8">Daftar untuk menjadi anggota English Court.</p>
                    <form id="signup-form" class="space-y-4">
                        <div>
                            <label for="signup-email" class="block text-sm font-bold text-slate-700 mb-2">Email</label>
                            <input type="email" id="signup-email" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" required>
                        </div>
                        <div>
                            <label for="signup-password" class="block text-sm font-bold text-slate-700 mb-2">Password</label>
                            <input type="password" id="signup-password" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" required>
                        </div>
                        <div id="signup-error" class="hidden text-red-500 text-sm text-center pt-1"></div>
                        <button type="submit" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all text-lg shadow-lg hover:shadow-blue-200">
                            Daftar
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div id="login-container" class="w-full max-w-md page-container">
            <div class="bg-white p-8 md:p-10 rounded-2xl shadow-2xl">
                <h2 class="text-3xl font-extrabold text-center text-slate-900 mb-2">Welcome Back!</h2>
                <p class="text-center text-slate-500 mb-8">Login untuk mengakses materi dan tugas Anda.</p>
                <form id="login-form" class="space-y-6">
                    <div>
                        <label for="login-email" class="block text-sm font-bold text-slate-700 mb-2">Email</label>
                        <input type="email" id="login-email" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" required>
                    </div>
                    <div>
                        <label for="login-password" class="block text-sm font-bold text-slate-700 mb-2">Password</label>
                        <input type="password" id="login-password" class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" required>
                    </div>
                     <div id="login-error" class="hidden text-red-500 text-sm text-center pt-1"></div>
                    <button type="submit" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all text-lg shadow-lg hover:shadow-blue-200">
                        Login
                    </button>
                </form>
            </div>
        </div>
    </main>
    
    <footer class="bg-white/80 backdrop-blur-lg mt-auto">
        <div class="container mx-auto px-6 py-4 text-center text-slate-500">
            &copy; 2025 English Court SMA Negeri 3 Lamongan.
        </div>
    </footer>

    <script>
        // Definisi elemen-elemen DOM
        const signupContainer = document.getElementById('signup-container');
        const loginContainer = document.getElementById('login-container');
        const navToggleButton = document.getElementById('nav-toggle-button');
        const signupForm = document.getElementById('signup-form');
        const loginForm = document.getElementById('login-form');
        const signupError = document.getElementById('signup-error');
        const loginError = document.getElementById('login-error');

        // ==== PENGHUBUNG KE SUPABASE ====
        // Ganti placeholder di bawah dengan URL dan Kunci yang sudah kamu simpan
        const SUPABASE_URL = 'https://jelcycdbdokcalsuptwm.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImplbGN5Y2RiZG9rY2Fsc3VwdHdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ0OTM0NTUsImV4cCI6MjA3MDA2OTQ1NX0.tjgC8FKPb8L3T84V5EyRg5KSc23zr0Kcb0w5VsP4d6I';
        // ================================

        // Membuat koneksi ke Supabase
        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        // Fungsi untuk berpindah halaman dengan animasi
        const switchPage = (pageToShow, pageToHide) => {
            pageToHide.classList.add('is-exiting');
            setTimeout(() => {
                pageToHide.classList.add('hidden');
                pageToHide.classList.remove('is-exiting');
                pageToShow.classList.remove('hidden');
            }, 300);
        };

        // Event listener untuk tombol navigasi header (Login/Sign Up)
        navToggleButton.addEventListener('click', () => {
            const isLoginVisible = !loginContainer.classList.contains('hidden');
            if (isLoginVisible) {
                switchPage(signupContainer, loginContainer);
                navToggleButton.textContent = 'Login';
            } else {
                switchPage(loginContainer, signupContainer);
                navToggleButton.textContent = 'Sign Up';
            }
        });

        // Logika Sign Up (Daftar)
        signupForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            signupError.classList.add('hidden');

            // Mengirim data pendaftaran ke Supabase
            const { data, error } = await supabase.auth.signUp({
                email: email,
                password: password,
            });

            if (error) {
                signupError.textContent = error.message;
                signupError.classList.remove('hidden');
            } else {
                alert('Pendaftaran berhasil! Silakan cek email untuk verifikasi (jika diaktifkan), lalu login.');
                switchPage(loginContainer, signupContainer); // Langsung pindah ke halaman login
                navToggleButton.textContent = 'Sign Up';
            }
        });

        // Logika Login
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            loginError.classList.add('hidden');

            // Mengirim data login ke Supabase untuk diperiksa
            const { data, error } = await supabase.auth.signInWithPassword({
                email: email,
                password: password,
            });

            if (error) {
                loginError.textContent = error.message;
                loginError.classList.remove('hidden');
            } else {
                alert('Login berhasil!');
                // Di sini nanti kita akan arahkan ke halaman beranda
                // window.location.href = './beranda.html';
            }
        });
    </script>
</body>
</html>