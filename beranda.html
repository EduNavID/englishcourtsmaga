<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beranda - English Court</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display.swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f1f5f9; /* slate-100 */
        }
        .carousel-track {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        .carousel-slide {
            min-width: 100%;
            position: relative;
        }
        .carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .carousel-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            padding: 3rem 1.5rem 1.5rem;
        }
        .nav-link-active {
            color: #2563eb; /* blue-600 */
            font-weight: 600;
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- Header dengan Menu Profil Dropdown -->
    <header class="bg-white/90 backdrop-blur-lg shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 py-3 flex justify-between items-center">
            <!-- Logo Section -->
            <a href="#" class="flex items-center gap-3">
                <img src="https://i.imgur.com/vOlASeq.png" alt="Logo SMAN 3 Lamongan" class="h-12 w-12">
                <div class="h-12 w-12 rounded-full border-2 border-dashed border-slate-400 flex items-center justify-center">
                    <span class="text-xs font-semibold text-slate-500 text-center">EC Logo</span>
                </div>
                <span class="text-xl font-bold text-blue-700 hidden sm:block">English Court</span>
            </a>
            
            <!-- Main Navigation (Desktop) -->
            <div class="hidden md:flex items-center space-x-8">
                <a href="#" class="nav-link-active">Beranda</a>
                <a href="#" class="text-slate-600 hover:text-blue-600 transition-colors">Materi</a>
                <a href="tugas.html" class="text-slate-600 hover:text-blue-600 transition-colors">Tugas</a>
                <a href="#" class="text-slate-600 hover:text-blue-600 transition-colors">Pengumuman</a>
            </div>

            <!-- Profile Dropdown -->
            <div class="relative">
                <button id="profile-button" class="flex items-center gap-2 group">
                    <img id="profile-avatar" src="https://placehold.co/40x40/dbeafe/4338ca?text=U" alt="User Avatar" class="w-10 h-10 rounded-full border-2 border-slate-200 group-hover:border-blue-400 transition object-cover">
                    <div class="hidden sm:block text-right">
                        <p class="font-semibold text-sm text-slate-700" id="user-email-display">Memuat...</p>
                        <p class="text-xs text-slate-500">Member</p>
                    </div>
                </button>
                <!-- Dropdown Menu -->
                <div id="profile-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl z-20 py-1">
                    <a href="#" class="flex items-center gap-3 px-4 py-2 text-sm text-slate-700 hover:bg-slate-100">
                        <svg class="w-5 h-5 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                        <span>Profil</span>
                    </a>
                    <div class="border-t border-slate-100 my-1"></div>
                    <a href="#" id="logout-button" class="flex items-center gap-3 w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                        <span>Logout</span>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <!-- Konten Utama Halaman Beranda -->
    <main class="container mx-auto px-4 sm:px-6 py-8">
        
        <!-- Bagian Sambutan -->
        <div class="bg-white p-6 sm:p-8 rounded-xl shadow-md mb-8">
            <h1 class="text-2xl sm:text-3xl font-bold text-slate-800" id="welcome-message">Selamat Datang!</h1>
            <p class="text-slate-600 mt-2">Jelajahi materi, lihat pengumuman, dan kumpulkan tugasmu di sini.</p>
        </div>

        <!-- Carousel Dokumentasi -->
        <div class="relative overflow-hidden bg-slate-200 rounded-xl shadow-lg aspect-w-16 aspect-h-9">
            <div class="carousel-track h-full">
                <!-- Slide 1 -->
                <div class="carousel-slide h-full">
                    <img src="https://images.unsplash.com/photo-1523240795612-9a054b0db644?q=80&w=2070&auto=format&fit=crop" alt="Dokumentasi 1">
                    <div class="carousel-caption">
                        <h3 class="text-lg sm:text-2xl font-bold">EC Debate Competition 2025</h3>
                    </div>
                </div>
                <!-- Slide 2 -->
                <div class="carousel-slide h-full">
                    <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?q=80&w=2071&auto=format&fit=crop" alt="Dokumentasi 2">
                    <div class="carousel-caption">
                        <h3 class="text-lg sm:text-2xl font-bold">Weekly Meeting</h3>
                    </div>
                </div>
                <!-- Slide 3 -->
                <div class="carousel-slide h-full">
                    <img src="https://images.unsplash.com/photo-1531482615713-2c657768cd91?q=80&w=2070&auto=format&fit=crop" alt="Dokumentasi 3">
                    <div class="carousel-caption">
                        <h3 class="text-lg sm:text-2xl font-bold">Guest Speaker Session</h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- Menu Navigasi Utama (Kartu) -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mt-8">
            <a href="#" class="block bg-white p-6 rounded-xl shadow-md hover:shadow-lg hover:-translate-y-1 transition-all">
                <h3 class="text-xl font-bold text-blue-700">üìö Materi Belajar</h3>
                <p class="text-slate-500 mt-1 text-sm">Akses semua modul dan catatan pertemuan.</p>
            </a>
            <a href="tugas.html" class="block bg-white p-6 rounded-xl shadow-md hover:shadow-lg hover:-translate-y-1 transition-all">
                <h3 class="text-xl font-bold text-green-700">üìù Kumpul Tugas</h3>
                <p class="text-slate-500 mt-1 text-sm">Lihat daftar tugas dan unggah pekerjaanmu.</p>
            </a>
            <a href="#" class="block bg-white p-6 rounded-xl shadow-md hover:shadow-lg hover:-translate-y-1 transition-all">
                <h3 class="text-xl font-bold text-yellow-700">üì¢ Pengumuman</h3>
                <p class="text-slate-500 mt-1 text-sm">Informasi terbaru seputar kegiatan EC.</p>
            </a>
            <a href="#" class="block bg-white p-6 rounded-xl shadow-md hover:shadow-lg hover:-translate-y-1 transition-all">
                <h3 class="text-xl font-bold text-purple-700">üë§ Profil Saya</h3>
                <p class="text-slate-500 mt-1 text-sm">Lihat dan atur informasi akun Anda.</p>
            </a>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const SUPABASE_URL = 'https://jelcycdbdokcalsuptwm.supabase.co';
            const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImplbGN5Y2RiZG9rY2Fsc3VwdHdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ0OTM0NTUsImV4cCI6MjA3MDA2OTQ1NX0.tjgC8FKPb8L3T84V5EyRg5KSc23zr0Kcb0w5VsP4d6I';
            
            const { createClient } = supabase;
            const supabaseClient = createClient(SUPABASE_URL, SUPABASE_KEY);

            const userEmailDisplay = document.getElementById('user-email-display');
            const welcomeMessage = document.getElementById('welcome-message');
            const logoutButton = document.getElementById('logout-button');
            const profileButton = document.getElementById('profile-button');
            const profileDropdown = document.getElementById('profile-dropdown');

            async function checkUserSession() {
                const { data, error } = await supabaseClient.auth.getSession();
                if (error || !data.session) {
                    window.location.href = './index.html';
                } else {
                    const userEmail = data.session.user.email;
                    userEmailDisplay.textContent = userEmail;
                    // Ambil bagian nama dari email untuk sapaan
                    const username = userEmail.split('@')[0];
                    welcomeMessage.textContent = `Selamat Datang, ${username}!`;
                }
            }

            logoutButton.addEventListener('click', async (e) => {
                e.preventDefault();
                await supabaseClient.auth.signOut();
                window.location.href = './index.html';
            });

            profileButton.addEventListener('click', () => {
                profileDropdown.classList.toggle('hidden');
            });
            
            window.addEventListener('click', (e) => {
                if (!profileButton.contains(e.target) && !profileDropdown.contains(e.target)) {
                    profileDropdown.classList.add('hidden');
                }
            });

            // --- LOGIKA CAROUSEL ---
            const track = document.querySelector('.carousel-track');
            if (track) {
                const slides = Array.from(track.children);
                let currentSlide = 0;
                const slideCount = slides.length;

                const moveToSlide = (index) => {
                    if (index < 0) index = slideCount - 1;
                    if (index >= slideCount) index = 0;
                    track.style.transform = 'translateX(-' + index * 100 + '%)';
                    currentSlide = index;
                };

                setInterval(() => {
                    moveToSlide(currentSlide + 1);
                }, 5000); // Ganti slide setiap 5 detik
            }

            checkUserSession();
        });
    </script>
</body>
</html>
